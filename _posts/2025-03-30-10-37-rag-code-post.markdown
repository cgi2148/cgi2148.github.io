---
layout: post
title:  "RAG ê¸°ë°˜ PDF ì§ˆë¬¸ ì‘ë‹µ ì‹œìŠ¤í…œ ì‹¤ìŠµ ê³¼ì œ"
date:   2025-03-30 10:37:00 +0900
categories: [konkuk, rag-code]
--- 
# ğŸ§  RAG ê¸°ë°˜ PDF ì§ˆë¬¸ ì‘ë‹µ ì‹œìŠ¤í…œ ì‹¤ìŠµ ê³¼ì œ

> LangChain, OpenAI, FAISSë¥¼ í™œìš©í•œ PDF ë¬¸ì„œ ê¸°ë°˜ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œ ì‹¤ìŠµ ì˜ˆì œì…ë‹ˆë‹¤.

---

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” PDF ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ **RAG (Retrieval-Augmented Generation)** ë°©ì‹ì„ ì´ìš©í•˜ì—¬ GPT ëª¨ë¸ì´ ë¬¸ì„œ ë‚´ìš©ì„ ì´í•´í•˜ê³ , ì§ˆë¬¸ì— ì‘ë‹µí•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ êµ¬ì„±í•œ ê²ƒì…ë‹ˆë‹¤.

---

## ğŸ”§ ì‚¬ìš© ê¸°ìˆ  ìŠ¤íƒ

- **LangChain**: LLMì„ ì¡°í•©í•˜ê³  ì²´ì¸í™”í•˜ëŠ” í”„ë ˆì„ì›Œí¬
- **PDFPlumber**: PDF ë¬¸ì„œì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
- **FAISS**: ë²¡í„° ê²€ìƒ‰ì„ ìœ„í•œ ê³ ì† ê²€ìƒ‰ ì—”ì§„
- **OpenAI API**: GPT-4o ë° Embedding ëª¨ë¸ í˜¸ì¶œ
- **LangChain Hub**: í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì €ì¥ì†Œ

---

## ğŸ—‚ï¸ í”„ë¡œì íŠ¸ êµ¬ì„±

### 1. ëª¨ë“ˆ ì„í¬íŠ¸ ë° ì„¤ì •

```python
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain_community.document_loaders import PDFPlumberLoader
from langchain_community.vectorstores import FAISS
from langchain_core.output_parsers import StrOutputParser
from langchain_core.runnables import RunnablePassthrough
from langchain_openai import ChatOpenAI, OpenAIEmbeddings
from langchain import hub
```

---

### 2. PDF ë¬¸ì„œ ë¶ˆëŸ¬ì˜¤ê¸°

```python
loader = PDFPlumberLoader("data/SPRI_AI_Brief_2023ë…„12ì›”í˜¸_F.pdf")
docs = loader.load()
```

- ğŸ“„ PDF íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.

---

### 3. ë¬¸ì„œ ë¶„í• 

```python
text_splitter = RecursiveCharacterTextSplitter(chunk_size=300, chunk_overlap=50)
split_documents = text_splitter.split_documents(docs)
```

- ê¸´ ë¬¸ì„œë¥¼ 300ì ë‹¨ìœ„ë¡œ ìë¥´ê³  50ì ì •ë„ ê²¹ì¹˜ê²Œ ë¶„í• í•˜ì—¬ ë¬¸ë§¥ ì†ì‹¤ì„ ì¤„ì…ë‹ˆë‹¤.

---

### 4. ë¬¸ì„œ ì„ë² ë”© ë° ë²¡í„° ì €ì¥ì†Œ ìƒì„±

```python
embeddings = OpenAIEmbeddings()
vectorstore = FAISS.from_documents(documents=split_documents, embedding=embeddings)
```

- ê° ë¬¸ì„œ ì¡°ê°ì„ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ FAISS ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.

---

### 5. ê²€ìƒ‰ê¸°(Retriever) ìƒì„±

```python
retriever = vectorstore.as_retriever()
```

- ì§ˆë¬¸ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ë¬¸ì„œë¥¼ ë¹ ë¥´ê²Œ ì°¾ê¸° ìœ„í•œ ê²€ìƒ‰ê¸°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

---

### 6. í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ë¡œë”©

```python
prompt = hub.pull("teddynote/rag-korean")
```

- LangChain Hubì—ì„œ í•œê¸€ì— ìµœì í™”ëœ RAG í”„ë¡¬í”„íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

---

### 7. GPT ëª¨ë¸ ì„¤ì •

```python
llm = ChatOpenAI(model_name="gpt-4o", temperature=0)
```

- GPT-4o ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì •ë°€í•˜ê³  ì¼ê´€ëœ ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤.

---

### 8. ì²´ì¸ êµ¬ì„± ë° ì—°ê²°

```python
chain = (
    {"context": retriever, "question": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)
```

- ì‚¬ìš©ì ì§ˆë¬¸ì„ ë°›ì•„ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ê³ , í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜í•´ GPTê°€ ì‘ë‹µì„ ìƒì„±í•˜ëŠ” ì „ì²´ íë¦„ì„ êµ¬ì„±í•©ë‹ˆë‹¤.

---

### 9. ì²´ì¸ ì‹¤í–‰ ì˜ˆì‹œ

```python
chain.invoke("ì‚¼ì„±ì „ìê°€ ê°œë°œí•œ ìƒì„±í˜• AI ì´ë¦„ì€?")
```

- ì‹¤í–‰ ê²°ê³¼:
```
"ì‚¼ì„±ì „ìê°€ ê°œë°œí•œ ìƒì„±í˜• AIì˜ ì´ë¦„ì€ 'ì‚¼ì„± ê°€ìš°ìŠ¤'ì…ë‹ˆë‹¤."
```

---

## âœ… ìš”ì•½

| ë‹¨ê³„ | ì„¤ëª… |
|------|------|
| 1 | PDF ë¬¸ì„œë¥¼ ë¡œë”© |
| 2 | ë¬¸ì„œë¥¼ ì²­í¬ë¡œ ë¶„í•  |
| 3 | ì„ë² ë”© ë²¡í„°ë¡œ ë³€í™˜ |
| 4 | ë²¡í„°ìŠ¤í† ì–´(FAISS) êµ¬ì¶• |
| 5 | ê²€ìƒ‰ê¸° ìƒì„± |
| 6 | í”„ë¡¬í”„íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° |
| 7 | GPT ëª¨ë¸ ì„¤ì • |
| 8 | ì²´ì¸ êµ¬ì„± ë° ì‹¤í–‰ |

---